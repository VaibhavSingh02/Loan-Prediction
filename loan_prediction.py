# -*- coding: utf-8 -*-
"""Loan_Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/11PPJd1EYBPnK3ja8QcyLbp-r9J9uNt7T
"""

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.decomposition import PCA
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from google.colab import files
#upload=files.upload()

tr_data=pd.read_csv("train.csv")
tr_data.info()
tr_data.isna().sum()

tr_data['Gender'].value_counts()
tr_data.Gender=tr_data.Gender.fillna('Male')
tr_data['Married'].value_counts()
tr_data.Married=tr_data.Married.fillna('Yes')
tr_data['Dependents'].value_counts()
tr_data.Dependents=tr_data.Dependents.fillna('0')
tr_data['Self_Employed'].value_counts()
tr_data.Self_Employed=tr_data.Self_Employed.fillna('No')
tr_data['LoanAmount'].value_counts()
tr_data.LoanAmount=tr_data.LoanAmount.fillna(120)
tr_data['Loan_Amount_Term'].value_counts()
tr_data.Loan_Amount_Term=tr_data.Loan_Amount_Term.fillna(360)
tr_data['Credit_History'].value_counts()
tr_data.Credit_History=tr_data.Credit_History.fillna(1.0)
tr_data.isna().sum()

x=tr_data.iloc[:,1:12].values
y=tr_data.iloc[:,12]
labelencoder=LabelEncoder()
pca=PCA(n_components=2)
print(x.shape)
for i in range(0,5):
 x[:,i]=labelencoder.fit_transform(x[:,i])
x[:,10]=labelencoder.fit_transform(x[:,i])
y=labelencoder.fit_transform(y)
x=pca.fit_transform(x)
x

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.15,random_state=0)
lr=LogisticRegression()
lr.fit(x_train,y_train)
y_pred=lr.predict(x_test)
y_pred
accuracy_score(y_pred,y_test)